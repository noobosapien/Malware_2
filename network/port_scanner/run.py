import socket 
import sys
from datetime import datetime
import errno

remoteserver = input("Enter the host to scan: ")
remoteserverip = socket.gethostbyname(remoteserver)

print("Enter the range of ports: ")
startport = input("Start port: ")
endport = input("End port: ")

print("Scanning... ", remoteserverip)
time_init = datetime.now()

try:

    for port in range(int(startport), int(endport)):
        print("\n")
        print("Checking TCP port: {}...".format(port))
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(5)
        result = sock.connect_ex((remoteserverip, port))

        if result == 0:
            print("TCP Port {}: Open".format(port))
        else:
            print("TCP Port {}: Closed".format(port))

        sock.close()


        print("Checking UDP port: {}...".format(port))
        sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        sock.settimeout(5)
        result = sock.connect_ex((remoteserverip, port))

        if result == 0:
            print("UDP Port {}: Open".format(port))
        else:
            print("UDP Port {}: Closed".format(port))

        
        sock.close()

except KeyboardInterrupt:
    print("Ctrl + C pressed")
    sys.exit()

except socket.gaierror:
    print("Hostname cannot be resolved. Exiting.")
    sys.exit()

except socket.error:
    print("Couldn't connect to the server.")
    sys.exit()

time_finish = datetime.now()
total = time_finish - time_init
print("Port scanning completed in: ", total)